---
import {
  getLangFromUrl,
  useTranslations,
  useTranslatedPath,
} from "../../i18n/utils";
import Section from "../common/ui/Section.astro";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const translatePath = useTranslatedPath(lang);

interface Props {
  theme?: "light" | "dark";
}

const { theme = "dark" } = Astro.props;
---

<Section theme={theme}>
  <!-- Centered Header -->
  <div class="max-w-3xl mx-auto text-center mb-16">
    <div
      class="text-primary-500 font-mono text-xs tracking-[0.2em] mb-4 uppercase flex items-center justify-center gap-3 animate-reveal"
    >
      <span class="w-1.5 h-1.5 bg-primary-500 rounded-full animate-pulse"
      ></span>
      0x0182 // {t("home.why.badge")}
    </div>
    <h2
      class="animate-reveal text-primary leading-[1.1] tracking-tighter mb-6 text-4xl md:text-5xl lg:text-6xl"
      style="animation-delay: 0.1s;"
    >
      {t("home.why.title_p1")}<br />
      <span class="gradient-text">{t("home.why.title_p2")}</span>
    </h2>
    <p
      class="animate-reveal text-secondary text-lg max-w-2xl mx-auto mb-8"
      style="animation-delay: 0.2s;"
    >
      {t("home.why.desc")}
    </p>
  </div>

  <!-- 50/50 Balanced Grid (2x2) -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 auto-rows-[340px]">
    <!-- 1. International Quality -->
    <div
      class="glass-card p-10 group relative overflow-hidden animate-reveal flex flex-col"
      style="animation-delay: 0.3s;"
    >
      <div class="relative z-10">
        <h3 class="text-2xl text-primary font-bold mb-4">
          {t("home.why.reason1.title")}
        </h3>
        <p class="text-secondary text-base leading-relaxed max-w-sm">
          {t("home.why.reason1.desc")}
        </p>
      </div>

      <!-- Hyper-Premium Global Network Graphic (Centered Bottom) -->
      <div class="flex-1 flex items-center justify-center relative mt-4">
        <div
          class="relative w-48 h-48 opacity-90 group-hover:opacity-100 transition-all duration-700"
        >
          <svg viewBox="0 0 200 200" class="w-full h-full fill-none">
            <defs>
              <radialGradient id="globeGradFinal" cx="50%" cy="50%" r="50%">
                <stop offset="0%" stop-color="#3b82f6" stop-opacity="0.6"
                ></stop>
                <stop offset="100%" stop-color="#3b82f6" stop-opacity="0"
                ></stop>
              </radialGradient>
            </defs>
            <!-- Orbiting HUD (Explicit Origin) -->
            <circle
              cx="100"
              cy="100"
              r="90"
              class="stroke-primary-500/30 stroke-[0.5] animate-spin-slow origin-center"
              stroke-dasharray="2 6"></circle>
            <circle
              cx="100"
              cy="100"
              r="80"
              class="stroke-primary-500/20 stroke-[1] animate-spin-reverse origin-center"
              stroke-dasharray="8 16"></circle>

            <!-- Glowing Core -->
            <circle
              cx="100"
              cy="100"
              r="55"
              fill="url(#globeGradFinal)"
              class="animate-pulse"></circle>

            <!-- Globe Lines (Stationary for stability) -->
            <g class="stroke-primary-400 stroke-[1.2]">
              <circle cx="100" cy="100" r="50" class="opacity-70"></circle>
              <ellipse cx="100" cy="100" rx="50" ry="15" class="opacity-50"
              ></ellipse>
              <ellipse cx="100" cy="100" rx="15" ry="50" class="opacity-50"
              ></ellipse>
            </g>

            <!-- Floating Nodes (Static positions, subtle pulse) -->
            <g class="fill-primary-300">
              <circle cx="100" cy="50" r="3" class="animate-pulse"></circle>
              <circle
                cx="150"
                cy="100"
                r="3"
                class="animate-pulse"
                style="animation-delay: 0.5s"></circle>
              <circle
                cx="50"
                cy="100"
                r="2.5"
                class="animate-pulse"
                style="animation-delay: 1s"></circle>
            </g>
          </svg>
        </div>
        <!-- Standardized Background Glow -->
        <div
          class="absolute inset-0 bg-primary-500/10 blur-[90px] rounded-full scale-125 pointer-events-none"
        >
        </div>
      </div>
      <div
        class="absolute inset-0 bg-gradient-to-t from-primary-500/10 to-transparent pointer-events-none"
      >
      </div>
    </div>

    <!-- 2. Optimized Cost -->
    <div
      class="glass-card p-10 group relative overflow-hidden animate-reveal flex flex-col"
      style="animation-delay: 0.4s;"
    >
      <div class="relative z-10">
        <h3 class="text-2xl text-primary font-bold mb-4">
          {t("home.why.reason2.title")}
        </h3>
        <p class="text-secondary text-base leading-relaxed max-w-sm">
          {t("home.why.reason2.desc")}
        </p>
      </div>

      <!-- Growth Visualization (Padded & Stable) -->
      <div class="flex-1 flex items-end justify-center pb-12 relative px-8">
        <div
          class="w-full h-32 relative opacity-80 group-hover:opacity-100 transition-opacity"
        >
          <svg
            viewBox="0 0 200 80"
            class="w-full h-full fill-none overflow-visible"
          >
            <defs>
              <linearGradient
                id="areaGradBal"
                x1="0%"
                y1="0%"
                x2="0%"
                y2="100%"
              >
                <stop offset="0%" stop-color="#3b82f6" stop-opacity="0.3"
                ></stop>
                <stop offset="100%" stop-color="#3b82f6" stop-opacity="0"
                ></stop>
              </linearGradient>
            </defs>
            <!-- Adjusted path to stay within 190 max-x for safety -->
            <path
              d="M10,70 Q35,65 60,45 T110,30 T160,20 T190,5 V80 H10 Z"
              fill="url(#areaGradBal)"
              stroke="none"
              class="opacity-0 group-hover:opacity-100 transition-opacity duration-1000 animate-slow-fade-pulse"
            ></path>
            <!-- Main Line -->
            <path
              d="M10,70 Q35,65 60,45 T110,30 T160,20 T190,5"
              stroke="#3b82f6"
              stroke-width="3"
              stroke-linecap="round"
              stroke-dasharray="350"
              stroke-dashoffset="350"
              class="animate-draw-path-once"></path>
            <!-- Pulse dot at 190,5 (SAFE MARGIN) -->
            <circle cx="190" cy="5" r="3" fill="#3b82f6"></circle>
          </svg>
        </div>
        <!-- Standardized Background Glow -->
        <div
          class="absolute inset-0 bg-primary-500/10 blur-[90px] rounded-full scale-125 pointer-events-none"
        >
        </div>
      </div>
      <div
        class="absolute inset-0 bg-gradient-to-t from-primary-500/10 to-transparent pointer-events-none"
      >
      </div>
    </div>

    <!-- 3. Absolute Security -->
    <div
      class="glass-card p-10 group relative overflow-hidden animate-reveal flex flex-col"
      style="animation-delay: 0.5s;"
    >
      <div class="relative z-10">
        <h3 class="text-2xl text-primary font-bold mb-4">
          {t("home.why.reason4.title")}
        </h3>
        <p class="text-secondary text-base leading-relaxed max-w-sm">
          {t("home.why.reason4.desc")}
        </p>
      </div>

      <!-- Security Visualization -->
      <div class="flex-1 flex items-center justify-center relative mt-4">
        <div
          class="w-28 h-28 rounded-2xl border border-white/10 flex items-center justify-center bg-dark-900/90 relative z-10 shadow-2xl backdrop-blur-md overflow-hidden"
        >
          <div
            class="absolute inset-0 bg-gradient-to-tr from-primary-500/20 to-transparent"
          >
          </div>
          <svg
            viewBox="0 0 24 24"
            class="w-12 h-12 text-primary-400 fill-none stroke-current stroke-[1.5]"
          >
            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
            <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
          </svg>
          <div
            class="absolute inset-x-0 h-[1.5px] bg-primary-400/80 blur-[1px] animate-scan-inner z-20"
          >
          </div>
        </div>
        <!-- Standardized Background Glow -->
        <div
          class="absolute inset-0 bg-primary-500/10 blur-[90px] rounded-full scale-125 pointer-events-none"
        >
        </div>
      </div>
      <div
        class="absolute inset-0 bg-gradient-to-t from-primary-500/10 to-transparent pointer-events-none"
      >
      </div>
    </div>

    <!-- 4. Fast Deployment -->
    <div
      class="glass-card p-10 group relative overflow-hidden animate-reveal flex flex-col"
      style="animation-delay: 0.6s;"
    >
      <div class="relative z-10">
        <h3 class="text-2xl text-primary font-bold mb-4">
          {t("home.why.reason3.title")}
        </h3>
        <p class="text-secondary text-base leading-relaxed max-w-sm">
          {t("home.why.reason3.desc")}
        </p>
      </div>

      <!-- High-Tech Gauge Deployment Visual -->
      <div class="flex-1 flex items-center justify-center py-4 relative">
        <div
          class="w-32 h-32 relative opacity-90 transition-transform duration-700"
        >
          <svg
            viewBox="0 0 100 100"
            class="w-full h-full transform -rotate-90 fill-none"
          >
            <circle
              cx="50"
              cy="50"
              r="42"
              stroke="currentColor"
              class="text-primary-500/10 stroke-[6]"></circle>
            <circle
              cx="50"
              cy="50"
              r="42"
              stroke="#3b82f6"
              class="stroke-[6] animate-fill-gauge origin-center"
              stroke-dasharray="264"
              stroke-dashoffset="264"
              stroke-linecap="round"></circle>
          </svg>
          <div
            class="absolute inset-0 flex flex-col items-center justify-center"
          >
            <span
              class="text-3xl font-bold text-primary font-mono tracking-tighter"
              >100%</span
            >
            <span
              class="text-[10px] text-primary-400 font-mono uppercase tracking-widest mt-[-2px]"
              >Active</span
            >
          </div>
          <div
            class="absolute inset-[-12px] border border-dashed border-primary-500/30 rounded-full animate-spin-slow origin-center"
          >
          </div>
        </div>
        <!-- Standardized Background Glow -->
        <div
          class="absolute inset-0 bg-primary-500/10 blur-[90px] rounded-full scale-125 pointer-events-none"
        >
        </div>
      </div>
      <div
        class="absolute inset-0 bg-gradient-to-t from-primary-500/10 to-transparent pointer-events-none"
      >
      </div>
    </div>
  </div>
</Section>

<style>
  .animate-spin-slow {
    animation: spin 20s linear infinite;
  }

  .animate-spin-reverse {
    animation: spin-reverse 25s linear infinite;
  }

  @keyframes spin {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }

  @keyframes spin-reverse {
    from {
      transform: rotate(360deg);
    }
    to {
      transform: rotate(0deg);
    }
  }

  @keyframes scan-inner {
    0%,
    100% {
      transform: translateY(-45px);
      opacity: 0;
    }
    50% {
      transform: translateY(45px);
      opacity: 1;
    }
  }

  .animate-scan-inner {
    animation: scan-inner 2.5s ease-in-out infinite;
  }

  .animate-pulse-slow {
    animation: pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  }

  @keyframes pulse {
    0%,
    100% {
      opacity: 1;
      transform: scale(1);
    }
    50% {
      opacity: 0.8;
      transform: scale(1.05);
    }
  }

  .animate-pulse-soft {
    animation: pulseSoft 2s ease-in-out infinite;
  }

  @keyframes pulseSoft {
    0%,
    100% {
      transform: scale(1);
      opacity: 0.3;
    }
    50% {
      transform: scale(1.5);
      opacity: 0.1;
    }
  }

  .animate-draw-path-once {
    animation: drawOnce 2.5s cubic-bezier(0.65, 0, 0.35, 1) forwards;
  }

  .group:hover .animate-draw-path-once {
    animation: drawOnce 1s cubic-bezier(0.65, 0, 0.35, 1) forwards;
  }

  @keyframes drawOnce {
    from {
      stroke-dashoffset: 350;
    }
    to {
      stroke-dashoffset: 0;
    }
  }

  .animate-fill-gauge {
    animation: fillGauge 2.5s cubic-bezier(0.65, 0, 0.35, 1) forwards;
  }

  @keyframes fillGauge {
    from {
      stroke-dashoffset: 264;
    }
    to {
      stroke-dashoffset: 60;
    }
  }

  .animate-glow-pulse {
    animation: glowPulse 4s ease-in-out infinite;
  }

  @keyframes glowPulse {
    0%,
    100% {
      filter: drop-shadow(0 0 2px #3b82f6) opacity(0.8);
      transform: scale(1);
    }
    50% {
      filter: drop-shadow(0 0 12px #3b82f6) opacity(1);
      transform: scale(1.2);
    }
  }

  .animate-slow-fade-pulse {
    animation: slowFadePulse 4s ease-in-out infinite;
  }

  @keyframes slowFadePulse {
    0%,
    100% {
      opacity: 0.1;
      filter: saturate(1) brightness(1);
    }
    50% {
      opacity: 1;
      filter: saturate(2) brightness(2) drop-shadow(0 0 20px #3b82f6);
    }
  }
</style>
